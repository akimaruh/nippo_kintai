<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.analix.project.mapper.MonthlyAttendanceReqMapper">

	<!-- 全件取得 -->
	<select id="findAllMonthlyAttendanceReq"
		resultType="com.analix.project.dto.MonthlyAttendanceReqDto">
		SELECT * FROM monthly_attendance_req
		JOIN users
		ON monthly_attendance_req.user_id = users.id
	</select>
	
	<!-- ログインユーザーのstatus取得 -->
	<select id="findStatusByUserId" parameterType="Integer">
		SELECT status FROM monthly_attendance_req
		WHERE user_id = #{userId}
		LIMIT 1
	</select>
		
	<!-- 承認 -->
	<update id="updateStatusApprove" parameterType="map">
		UPDATE monthly_attendance_req
		SET status = 2
		WHERE user_id = #{userId} AND target_year_month = #{targetYearMonth}
	</update>
		
	<!-- 却下 -->
	<update id="updateStatusReject" parameterType="map">
		UPDATE monthly_attendance_req
		SET status = 3
		WHERE user_id = #{userId} AND target_year_month = #{targetYearMonth}
	</update>

</mapper>