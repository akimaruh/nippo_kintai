<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<!--	 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"-->
	<!--            integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"-->
	<!--            crossorigin="anonymous"></script>-->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
	<title>勤怠登録画面</title>
</head>

<body>

	<div class="mb-3">
		<label for="name">ユーザー名：</label>
		<span th:text="${session.loginUser.name}"></span>
		<label for="id">ユーザーID：</label>
		<span th:text="${session.loginUser.id}"></span>
		<label for="status">ステータス：</label>
		<span th:text="未承認"></span>

	</div>

	<div class="mb-3">
		<form action="" method="get">
			<label for="displayYearMonth">表示年月：</label>
			<input type="text" />年
			<input type="text" />月
			<input type="submit" class="btn btn-info" value="表示" />
		</form>


	</div>

	<div class="mb-3">
		<input type="submit" class="btn btn-info" value="却下" />
		<input type="submit" class="btn btn-info" value="承認" />
		<input type="submit" class="btn btn-info" value="承認申請" />
		<input type="submit" class="btn btn-info" value="登録" />
	</div>

	<!--	<th:block="${session.users.role == Manager}">-->
	<table class="table table-hover sortabletable dataTable no-footer" id="user-table" role="grid"
		aria-describedby="user-table_info">
		<thead>
			<tr>
				<th>承認申請者</th>
				<th>申請対象年月</th>
				<th>申請日</th>
			</tr>
		</thead>
		<tbody>

		</tbody>
	</table>

	<!--	</th:block>-->

	<table class="table table-hover sortabletable dataTable no-footer" id="user-table" role="grid"
		aria-describedby="user-table_info">
		<div id="calendar">
			<button id="prev-month">前月</button>
			<button id="next-month">翌月</button>
			<thead>
				<tr>
					<th>日付</th>
					<th>曜日</th>
					<th>勤務状況</th>
					<th>出勤時間</th>
					<th>退勤時間</th>
					<th>備考</th>
				</tr>
			</thead>
			<tbody id="calendar-body">
				<script th:inline="javascript">
					/* サーバーサイドから現在の月と年を渡す */
					const initialMonth = /*[[${currentMonth}]]*/ 0;
					const initialYear = /*[[${currentYear}]]*/ 0;

				</script>
			</tbody>
	</table>
	</div>




	<!--	<script th:src="@{/js/attendance.js}">-->
	<script>
		document.addEventListener('DOMContentLoaded', function () {
			const calendarBody = document.getElementById('calendar-body');
			const prevMonthButton = document.getElementById('prev-month');
			const nextMonthButton = document.getElementById('next-month');


			let currentMonth = initialMonth !== 0 ? initialMonth - 1 : new Date().getMonth();
			let currentYear = initialYear !== 0 ? initialYear : new Date().getFullYear();

			function generateCalendar(month, year) {
				calendarBody.innerHTML = ''; // カレンダーをリセット
				let daysInMonth = new Date(year, month + 1, 0).getDate();

				// カレンダーの行を生成
				for (let date = 1; date <= daysInMonth; date++) {
					let row = document.createElement('tr');

					// 日付セル
					let dateCell = document.createElement('td');
					dateCell.appendChild(document.createTextNode(`${year}-${month + 1}-${date}`));
					row.appendChild(dateCell);

					// 曜日セル
					let dayOfWeek = new Date(year, month, date).getDay();
					let dayOfWeekCell = document.createElement('td');
					dayOfWeekCell.appendChild(document.createTextNode(['日', '月', '火', '水', '木', '金', '土'][dayOfWeek]));
					row.appendChild(dayOfWeekCell);

					// 勤務状況セル
					let workStatusCell = document.createElement('td');
					let workStatusSelect = document.createElement('select');
					['出勤', '休日', '休暇', '病欠', 'その他'].forEach(status => {
						let option = document.createElement('option');
						option.value = status;
						option.text = status;
						workStatusSelect.appendChild(option);
					});

					workStatusCell.appendChild(workStatusSelect);
					row.appendChild(workStatusCell);

					// 出勤時間セル
					let startTimeCell = document.createElement('td');
					let startTimeInput = document.createElement('input');
					startTimeInput.type = 'time';
					startTimeCell.appendChild(startTimeInput);
					row.appendChild(startTimeCell);

					// 退勤時間セル
					let endTimeCell = document.createElement('td');
					let endTimeInput = document.createElement('input');
					endTimeInput.type = 'time';
					endTimeCell.appendChild(endTimeInput);
					row.appendChild(endTimeCell);

					// 備考セル
					let noteCell = document.createElement('td');
					let noteInput = document.createElement('input');
					noteInput.type = 'text';
					noteCell.appendChild(noteInput);
					row.appendChild(noteCell);

					calendarBody.appendChild(row);
				}
			}

			prevMonthButton.addEventListener('click', function () {
				if (currentMonth === 0) {
					currentMonth = 11;
					currentYear--;
				} else {
					currentMonth--;
				}
				generateCalendar(currentMonth, currentYear);
			});

			nextMonthButton.addEventListener('click', function () {
				if (currentMonth === 11) {
					currentMonth = 0;
					currentYear++;
				} else {
					currentMonth++;
				}
				generateCalendar(currentMonth, currentYear);
			});

			generateCalendar(currentMonth, currentYear);
		});

	</script>
</body>

</html>